const tableWrapper=document.querySelector(".datetable_wrapper ");function Calendar2(e,t,a){var n=new Date(t,a+1,0).getDate(),l=new Date(t,a,n),r=new Date(l.getFullYear(),l.getMonth(),n).getDay(),c=new Date(l.getFullYear(),l.getMonth(),1).getDay(),d="<tr>";if(a=["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],0!=c)for(var o=1;o<c;o++)d+="<td>";else for(o=0;o<6;o++)d+="<td>";for(o=1;o<=n;o++)o==(new Date).getDate()&&l.getFullYear()==(new Date).getFullYear()&&(l.getMonth(),(new Date).getMonth()),d+='<td class="havedate">'+o,0==new Date(l.getFullYear(),l.getMonth(),o).getDay()&&(d+="<tr>");for(o=r;o<7;o++)d+="<td>&nbsp;";document.querySelector("#"+e+" tbody").innerHTML=d,document.querySelector("#"+e+" thead tr:nth-child(2) td:nth-child(2)").innerHTML='<div><select class="CalendarSelectt"><option value="0">Январь</option><option value="1">Февраль</option><option value="2">Март</option><option value="3">Апрель</option><option value="4" selected>Май</option><option value="5">Июнь</option><option value="6">Июль</option><option value="7">Август</option><option value="8">Сентябрь</option><option value="9">Октябрь</option><option value="10">Ноябрь</option><option value="11">Декабрь</option></select></div>',document.querySelector("#"+e+" thead td:nth-child(2)").innerHTML='<div><select class="CalendarSelectt"><option value="2020">2020</option><option value="2021">2021</option><option value="2022">2022</option></select></div>';let i=document.querySelectorAll("#"+e+" tr:nth-child(1) option"),u=document.querySelectorAll("#"+e+" tr:nth-child(2) option");for(let e=0;e<u.length;e++)u[e].hasAttribute("selected")&&u[e].removeAttribute("selected"),u[e].value==l.getMonth()&&u[e].setAttribute("selected",!0);for(let e=0;e<i.length;e++)i[e].hasAttribute("selected")&&i[e].removeAttribute("selected"),i[e].value==l.getFullYear()&&i[e].setAttribute("selected",!0);document.querySelector("#"+e+" thead td:nth-child(2)").dataset.month=l.getMonth(),document.querySelector("#"+e+" thead td:nth-child(2)").dataset.year=l.getFullYear(),document.querySelectorAll("#"+e+" tbody tr").length<6&&(document.querySelector("#"+e+" tbody").innerHTML+='<tr class="table_last_row"><td>&nbsp;<td>&nbsp;<td>&nbsp;<td>&nbsp;<td>&nbsp;<td>&nbsp;<td>&nbsp;');let h=document.querySelectorAll(".table_last_row");if(2==h.length)for(let e=0;e<h.length;e++)h[e].remove()}document.querySelector("#calendar2_out").onclick=function(){document.querySelector(".datetable_wrapper").classList.toggle("datetable_active")},document.querySelector("#calendar3_out").onclick=function(){document.querySelector(".datetable_wrapper").classList.toggle("datetable_active")},months=["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],Calendar2("calendar2",(new Date).getFullYear(),0),Calendar2("calendar3",(new Date).getFullYear(),0);let calendarsData=getCalendarsData(),clickEvent=new Event("click");function getCalendarsData(e=null,t=null){let a,n,l=document.querySelector("#calendar2"),r=document.querySelector("#calendar3"),c=l.querySelector(".havedate"),d=r.querySelectorAll(".havedate"),o=d[d.length-1];if(e&&t){if(a=Array.from(l.querySelectorAll(".havedate")).find((t=>parseInt(t.innerHTML)==e)),n=Array.from(r.querySelectorAll(".havedate")).find((e=>parseInt(e.innerHTML)==t)),!a&&e>28){let e=l.querySelectorAll(".havedate");a=e[e.length-1]}if(!n&&t>28){let e=r.querySelectorAll(".havedate");n=e[e.length-1]}}else{let e=l.querySelector(".active_date"),t=r.querySelector(".active_date");e&&(a=parseInt(e.innerHTML)),t&&(n=parseInt(t.innerHTML))}return{cdr2:l,cdr3:r,cdr2Day:a,cdr3Day:n,cdr2FirstDay:c,cdr3LastDay:o}}function calendar2Start(){for(u=0,calendar2tdList=document.querySelectorAll("#calendar2 .havedate"),u=0;u<calendar2tdList.length;u++)calendar2tdList[u].onclick=function(e){let t=this.innerText;t>=1&t<=9&&(t="0"+t);let a=parseInt(document.querySelector("#calendar2 thead tr:nth-child(2) select").value);month2List=months[a],"Август"==month2List||"Март"==month2List?month2List+="а":(month2List=month2List.slice(0,-1),month2List+="я"),year2List=document.querySelector("#calendar2 thead tr:nth-child(1) select").value;let n=document.querySelector("#calendar2_out");for(n.innerText=t+" "+month2List+" "+year2List,n.dataset.dateValue=`${t}.${a+1}.${year2List}`,document.querySelector("#calendar2").parentElement.childNodes[1].value=t+" "+month2List+" "+year2List,this.classList.add("active_date"),i=0;i<calendar2tdList.length;i++)calendar2tdList[i].classList.remove("active_date");this.classList.add("active_date"),tableWrapper.dispatchEvent(new CustomEvent("date-change",{detail:{calendarNum:2,isTrusted:e.isTrusted}}))}}setTimeout((()=>{calendarsData.cdr2FirstDay.dispatchEvent(clickEvent),calendarsData.cdr3LastDay.dispatchEvent(clickEvent)}),0),calendar2Start();var cal2selYear=0;CalenSelcYear2=document.querySelector("#calendar2 > thead > tr:nth-child(1) td:nth-child(2)"),CalenSelcYear2.onclick=function(){(cal2selYear+=1)%2==0&&(cal2YearGet=parseFloat(document.querySelector("#calendar2 thead tr:nth-child(1) select").value),Calendar2("calendar2",cal2YearGet,document.querySelector("#calendar2 thead td:nth-child(2)").dataset.month),calendar2Start())};var cal3selYear=0;CalenSelcYear3=document.querySelector("#calendar3 > thead > tr:nth-child(1) td:nth-child(2)"),CalenSelcYear3.onclick=function(){(cal3selYear+=1)%2==0&&(cal3YearGet=parseFloat(document.querySelector("#calendar3 thead tr:nth-child(1) select").value),Calendar2("calendar3",cal3YearGet,document.querySelector("#calendar3 thead td:nth-child(2)").dataset.month),calendar3Start())};var cal2selMonth=0;CalenSelcMonth2=document.querySelector("#calendar2 > thead > tr:nth-child(2) td:nth-child(2)"),CalenSelcMonth2.onclick=function(){(cal2selMonth+=1)%2==0&&(cal2MonthGet=parseFloat(document.querySelector("#calendar2 thead tr:nth-child(2) select").value),Calendar2("calendar2",document.querySelector("#calendar2 thead td:nth-child(2)").dataset.year,cal2MonthGet),calendar2Start())};var cal3selMonth=0;function calendar2MonthMinus(){Calendar2("calendar2",document.querySelector("#calendar2 thead td:nth-child(2)").dataset.year,parseFloat(document.querySelector("#calendar2 thead td:nth-child(2)").dataset.month)-1),calendar2Start()}function calendar2MonthPlus(){Calendar2("calendar2",document.querySelector("#calendar2 thead td:nth-child(2)").dataset.year,parseFloat(document.querySelector("#calendar2 thead td:nth-child(2)").dataset.month)+1),calendar2Start()}function calendar2YearMinus(){2020==document.querySelector("#calendar2 thead td:nth-child(2)").dataset.year?alert("У вас нет в выбираемом периоде резюме соискателей"):(Calendar2("calendar2",parseFloat(document.querySelector("#calendar2 thead td:nth-child(2)").dataset.year)-1,document.querySelector("#calendar2 thead td:nth-child(2)").dataset.month),calendar2Start())}function calendar2YearPlus(){2022==document.querySelector("#calendar2 thead td:nth-child(2)").dataset.year?alert("У вас нет в выбираемом периоде резюме соискателей"):(Calendar2("calendar2",parseFloat(document.querySelector("#calendar2 thead td:nth-child(2)").dataset.year)+1,document.querySelector("#calendar2 thead td:nth-child(2)").dataset.month),calendar2Start())}function calendar3Start(){for(u=0,calendar3tdList=document.querySelectorAll("#calendar3 .havedate"),u=0;u<calendar3tdList.length;u++)calendar3tdList[u].onclick=function(e){let t=this.innerText;t>=1&t<=9&&(t="0"+t);let a=parseInt(document.querySelector("#calendar3 thead tr:nth-child(2) select").value);month3List=months[a],"Август"==month3List||"Март"==month3List?month3List+="а":(month3List=month3List.slice(0,-1),month3List+="я"),year3List=document.querySelector("#calendar3 thead tr:nth-child(1) select").value;let n=document.querySelector("#calendar3_out");for(n.innerText=t+" "+month2List+" "+year2List,n.dataset.dateValue=`${t}.${a+1}.${year2List}`,n.innerText=t+" "+month3List+" "+year3List,n.dataset.dateValue=`${t}.${a+1}.${year3List}`,document.querySelector("#calendar3").parentElement.childNodes[1].value=t+" "+month3List+" "+year3List,i=0;i<calendar3tdList.length;i++)calendar3tdList[i].classList.remove("active_date");this.classList.add("active_date"),document.querySelector(".datetable_wrapper").classList.remove("datetable_active"),tableWrapper.dispatchEvent(new CustomEvent("date-change",{detail:{calendarNum:3,isTrusted:e.isTrusted}}))}}function calendar3MonthPlus(){Calendar2("calendar3",document.querySelector("#calendar3 thead td:nth-child(2)").dataset.year,parseFloat(document.querySelector("#calendar3 thead td:nth-child(2)").dataset.month)+1),calendar3Start()}function calendar3MonthMinus(){Calendar2("calendar3",document.querySelector("#calendar3 thead td:nth-child(2)").dataset.year,parseFloat(document.querySelector("#calendar3 thead td:nth-child(2)").dataset.month)-1),calendar3Start()}function calendar3YearMinus(){2020==document.querySelector("#calendar3 thead td:nth-child(2)").dataset.year?alert("У вас нет в выбираемом периоде резюме соискателей"):(Calendar2("calendar3",parseFloat(document.querySelector("#calendar3 thead td:nth-child(2)").dataset.year)-1,document.querySelector("#calendar3 thead td:nth-child(2)").dataset.month),calendar3Start())}function calendar3YearPlus(){2022==document.querySelector("#calendar3 thead td:nth-child(2)").dataset.year?alert("У вас нет в выбираемом периоде резюме соискателей"):(Calendar2("calendar3",parseFloat(document.querySelector("#calendar3 thead td:nth-child(2)").dataset.year)+1,document.querySelector("#calendar3 thead td:nth-child(2)").dataset.month),calendar3Start())}CalenSelc3=document.querySelector("#calendar3 > thead > tr:nth-child(2) td:nth-child(2)"),CalenSelc3.onclick=function(){(cal3selMonth+=1)%2==0&&(cal3MonthGet=parseFloat(document.querySelector("#calendar3 thead tr:nth-child(2) select").value),Calendar2("calendar3",document.querySelector("#calendar3 thead td:nth-child(2)").dataset.year,cal3MonthGet),calendar3Start())},document.querySelector(" #calendar2 thead tr:nth-child(2) td:nth-child(1)").onclick=calendar2MonthMinus,document.querySelector(" #calendar2 thead tr:nth-child(2) td:nth-child(3)").onclick=calendar2MonthPlus,document.querySelector(" #calendar2 thead tr:nth-child(1) td:nth-child(1)").onclick=calendar2YearMinus,document.querySelector("#calendar2 thead tr:nth-child(1) td:nth-child(3) ").onclick=calendar2YearPlus,calendar3Start(),document.querySelector("#calendar3 thead tr:nth-child(2) td:nth-child(1)").onclick=calendar3MonthMinus,document.querySelector(" #calendar3 thead tr:nth-child(2) td:nth-child(3)").onclick=calendar3MonthPlus,document.querySelector("#calendar3 thead tr:nth-child(1) td:nth-child(1) ").onclick=calendar3YearMinus,document.querySelector("#calendar3 thead tr:nth-child(1) td:nth-child(3) ").onclick=calendar3YearPlus,document.querySelector(".datetable_wrapper > button").addEventListener("click",(e=>{document.querySelector(".datetable_wrapper").classList.remove("datetable_active")}));let calendarDayBack=document.querySelector("#calendar_day-back"),calendarMonthBack=document.querySelector("#calendar_month-back"),calendarDayNext=document.querySelector("#calendar_day-next"),calendarMonthNext=document.querySelector("#calendar_month-next"),calendarAllPeriod=document.querySelector("#calendar_period");function calendarControlsMonth(e="back"){let t=getCalendarsData();"back"==e?calendar3MonthMinus():calendar3MonthPlus();let a=getCalendarsData(t.cdr2Day,t.cdr3Day);a.cdr2Day.dispatchEvent(clickEvent),a.cdr3Day.dispatchEvent(clickEvent)}function calendarControlsDay(e="back"){let t=getCalendarsData();if("back"===e){t.cdr3Day<=1?function(e="2"){"2"===e?calendar2MonthMinus():calendar3MonthMinus();let t=getCalendarsData(),a=("2"===e?t.cdr2:t.cdr3).querySelectorAll(".havedate");a[a.length-1].dispatchEvent(clickEvent)}("3"):function(e="2"){let a="2"===e?t.cdr2:t.cdr3,n="2"===e?t.cdr2Day:t.cdr3Day,l=parseInt(n)-1;Array.from(a.querySelectorAll(".havedate")).find((e=>parseInt(e.innerHTML)===l)).dispatchEvent(clickEvent)}("3")}if("next"===e){let e=function(e="2"){let a="2"===e?t.cdr2:t.cdr3,n="2"===e?t.cdr2Day:t.cdr3Day,l=parseInt(n)+1;return{nextDayBlock:Array.from(a.querySelectorAll(".havedate")).find((e=>parseInt(e.innerHTML)===l)),nextDay:l}}("3");e.nextDayBlock?e.nextDayBlock.dispatchEvent(clickEvent):function(e="2"){"2"==e?calendar2MonthPlus():calendar3MonthPlus();let t=getCalendarsData();("2"==e?t.cdr2:t.cdr3).querySelector(".havedate").dispatchEvent(clickEvent)}("3")}}function calendarControlsPeriod(){Calendar2("calendar2",2020,0),Calendar2("calendar3",(new Date).getFullYear(),11),calendar2Start(),calendar3Start();let e=getCalendarsData();e.cdr2FirstDay.dispatchEvent(clickEvent),e.cdr3LastDay.dispatchEvent(clickEvent)}calendarMonthBack.addEventListener("click",(()=>calendarControlsMonth("back"))),calendarMonthNext.addEventListener("click",(()=>calendarControlsMonth("next"))),calendarDayBack.addEventListener("click",(()=>calendarControlsDay("back"))),calendarDayNext.addEventListener("click",(()=>calendarControlsDay("next"))),calendarAllPeriod.addEventListener("click",(()=>calendarControlsPeriod())),tableWrapper.addEventListener("date-change",(function(e){setTimeout((()=>{let t=document.querySelector("#calendar2_out").dataset.dateValue,a=document.querySelector("#calendar3_out").dataset.dateValue;if(t&&a){t=t.split(".").map((e=>parseInt(e))),a=a.split(".").map((e=>parseInt(e)));let n={start:t[0],end:a[0]},l={start:t[1],end:a[1]},r={start:t[2],end:a[2]},c=r.start>r.end,d=!c&&l.start>l.end,o=!c&&!d&&n.start>n.end;if(c||d||o){if(2==e.detail.calendarNum||!e.detail.isTrusted){Calendar2("calendar3",r.start,l.start-1),calendar3Start();let e=Array.from(document.querySelectorAll("#calendar3 .havedate")).find((e=>e.textContent==n.start));e&&e.dispatchEvent(clickEvent)}if(3==e.detail.calendarNum&&e.detail.isTrusted&&e.detail.isTrusted){Calendar2("calendar2",r.end,l.end-1),calendar2Start();let e=Array.from(document.querySelectorAll("#calendar2 .havedate")).find((e=>e.textContent==n.end));e&&e.dispatchEvent(clickEvent)}}}}),0)}));